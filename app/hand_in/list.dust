<!DOCTYPE html>
<html>
  <head>
    <title>Hand-in</title>
    <style src="app/subjects/subject.scss"></style>
    <style src="app/header/head.scss"></style>
    <style src="app/hand_in/list.scss"></style>
    <script src="app/subjects/polyfill.js"></script>
    <script src="components/x-bubble.js"></script>
    <script src="components/x-slidable.js"></script>
    <script src="components/x-opendialog.js"></script>
    <script src="components/x-destroy.js"></script>
    <link href="/foundation-icons/foundation-icons.css" rel="stylesheet"/>
    {>"app/header/global.dust"/}
  </head>
  <body>
    {>"app/header/head.dust"/}
    <main>
      {>"app/subjects/nav.dust" active="hand_in"/}
      <div>
	{@ne key=user.role value="student"}
	  <section class="toolbar">
	    <button cite="#newSlotForm">Add Hand-in Folder</button>
	  </section>
	  <x-slidable id="newSlotForm" hidden>
	    <form method="post">
	      <input type="text" name="name" placeholder="Title" aria-required="true" required/>
	      <button type="submit" class="publishButton">Submit</button>
	    </form>
	  </x-slidable>
	{/ne}
	<ul id="hand_in_slots">
	  {#subject.hand_in}
	    <li>
	      {name}
	      {@eq key=user.role value="student"}
		{@pluck key=files value="user"}
		  {@stringify}		
		    {@lacks value=user._id}
		      <x-destroy id="destroy{$idx}">
			<x-opendialog id="handInSlot{$idx}" action="/subjects/{subject._id}/hand_in/{_id}/files" cite="destroy{$idx}">
			  <button class="uploadButton" cite="#handInSlot{$idx}">
			    Submit		    
			  </button>
			</x-opendialog>
		      </x-destroy>
		    {/lacks}
		  {/stringify}
		{/pluck}
		<span class="submitted"><i class="fi-check"></i></span>
		{:else}
		<button class="deleteButton">Delete</button>
		<a href="/subjects/{subject._id}/hand_in/{_id}/files" class="viewButton">View</a>
	      {/eq}
	    </li> 
		{/subject.hand_in}
	</ul>
      </div>
    </main>
  </body>
</html>
