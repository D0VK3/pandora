<!DOCTYPE html>
<html>
  <head>
    <title>{subject.title}</title>
    <style src="./subject.scss"></style>
    <style src="../header/head.scss"></style>
    <script src="./polyfill.js"></script>
    <script src="../../components/x-slidable.js"></script>
    <script src="../../components/x-richtexteditor.js"></script>
    <script src="../../components/x-snowfall.js"></script>
    <link href="/foundation-icons/foundation-icons.css" rel="stylesheet"/>
  </head>
  <body>
    <x-snowfall count="800">
      {>"app/header/head.dust"/}
      <main>
	{>"app/subjects/nav.dust" active="blog"/}
	<div>
	  {@ne key=user.role value="student"}
	    {?nova}
	      <x-slidable id="newPostForm">
	    {:else}
		<x-slidable id="newPostForm" class="jsmore" hidden>
	    {/nova}
	    <form action="/subjects/{subject._id}" method="post">
	      <input name="title" type="text" placeholder="Title" required/>
	      <div class="jsmore">
		<div class="toolbar">
		  <ul>
		    <button exec="bold"><i class="fi-bold"></i></button>
		    <button exec="italic"><i class="fi-italic"></i></button>
		    <button exec="underline"><i class="fi-underline"></i></button>
		  </ul>
		  <ul>
		    <button exec="insertOrderedList"><i class="fi-list-number"></i></button>
		    <button exec="insertUnorderedList"><i class="fi-list-bullet"></i></button>
		  </ul>
		  <ul>
		    <button exec="subscript"><i class="fi-subscript"></i></button>
		    <button exec="superscript"><i class="fi-superscript"></i></button>
		  </ul>
		</div>
		<br/>
		<x-richtexteditor for="#content"></x-richtexteditor>
	      </div>
	      <textarea name="body" class="jsless" id="content"></textarea>
	      <span id="buttons">
		<button type="submit" formaction="/subjects/{subject._id}?drafts=true">Save As Draft</button>
		<button type="submit">Publish</button>
	      </span>
	    </form>
		</x-slidable>
	  {/ne}

	      {#blog}
		<article class="post">
		  <header class="postHeading">
	    	    <h2><a href="/subjects/{subject._id}/posts/{_id}">{title}</a></h2>
	  	  </header>

	  	  <section class="postActions">
	    	    {@ne key=user.role value="student"}
	    	      <form action="/subjects/{subject._id}/posts/{_id}" method="post">
	      		<input type="hidden" name="_method" value="delete"/>
	     		<button class="deletePost" title="Remove" type="submit"><i class="fi-x"></i></button>
	    	      </form>
	    	      <button class="editPost" title="Edit"><i class="fi-pencil"></i></button>
	    	      {?draft}
	    		<button class="publishPost" title="Publish"><i class="fi-check"></i></button>
	   	      {/draft}
	    	    {/ne}
	  	  </section>	   

	  	  <section class="postMeta">
	    	    {?draft}
	    	      <h6 class="indicatorDraft">Draft</h6>
	    	    {:else}
	    	      <h6>Published on {date}</h6>
	    	    {/draft}
	  	  </section>

	  	  <section class="postExcerpt">
	  	    {body|s}
	  	  </section>
		</article>
	      {/blog}
	</div>
      </main>
    </x-snowfall>
  </body>
</html>
