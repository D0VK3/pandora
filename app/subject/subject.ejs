<html>
  <head>
    <title><%= subject.name %></title>
    <style src="./subject.scss"></style>
    <script src="./polyfill.js"></script>
    <script src="./subject.js"></script>
  </head>
  <body>
    <% include ../index/header.ejs %>
    <main class="row">
      <nav>
	<h4>Latin <small>Mrs Cavalier</small></h4>
	<form>
	  <input type="search" placeholder="Search"></input>
	</form>
	<ul>
	  <li class="active"><a href="/<%= subject._id %>">Blog</a></li>
	  <% if(subject.vocab_quizzes.length != 0) { %>
          <li><a>Vocab Quizzes</a></li>
	  <% } %>
	  <li><a>Student Resources</a></li>

	</ul>
	<% if(user.role === "admin" || user.role === "teacher") { %>
	<a href="#newPostForm" id="newPost"><i class="fi-plus"></i> New Blog Post</a>
	<% } %>
      </nav>
      <div>
	<x-slidable id="newPostForm" hidden>
	  <form action="/<%= subject._id %>" method="post">
	    <input name="title" type="text" placeholder="Title" required/>
	    <span id="formattingButtons">
	      <button>B</button>
	      <button>I</button>
	      <button>U</button>
	    </span>
	    <br/>
	    <textarea name="body"></textarea>
	    <span id="buttons">
	      <button type="submit" formaction="/<%= subject._id %>?drafts=true">Save As Draft</button>
	      <button type="submit">Publish</button>
	    </span>
	  </form>
	</x-slidable>

	<% subject.blog.reverse().forEach(function(post) { %>
	<% if(!post.draft || user.role === "teacher" || user.role === "admin") { %>
	<section>
	  <div class="heading">
	    <h2><%= post.title %></h2>
	    <% if(user.role === "admin" || user.role === "teacher") { %>
	    <div class="buttons">
	      <button class="editPost">Edit</button>
	      <button class="deletePost">Delete</button>
	      <% if(post.draft) { %>
	      <button class="publishPost">Publish</button>
	      <% } %>
	    </div>
	  </div>
	  <% if(post.draft) { %>
	  <h6 class="indicatorDraft">Draft</h6>
	  <% } %>
	  <br/>
	  <% } %>
	  <div class="body">
	  <%= us.prune(post.body, 500) %>
	  </div>
	</section>
	<% } %>
	<% }); %>
      </div>
    </main>
  </body>
</html>
